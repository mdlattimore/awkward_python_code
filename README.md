Code from the Awkward Python blog.